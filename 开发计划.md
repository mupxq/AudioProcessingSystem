# Fun-ASR 语音识别批量处理系统 - 开发计划

## 项目概述

开发一个基于Fun-ASR-Nano-2512模型的本地语音识别批量处理系统，支持文件夹选择、批量音频识别和结果导出。

## 技术栈

- **后端**: Python + Flask/FastAPI（本地运行）
- **前端**: 原生HTML/CSS/JavaScript（单体网页）
- **AI模型**: Fun-ASR-Nano-2512（本地推理）
- **音频处理**: funASR库
- **部署方式**: 本地启动 `python app.py`，浏览器访问 `http://localhost:5000`

---

## 核心设计原则

⚡ **纯本地处理** - 所有文件操作在本地文件系统完成，无网络传输

---

## 开发阶段

### 阶段一：环境准备与模型配置（第1-2天）

#### 1.1 项目初始化
- [ ] 创建项目目录结构
- [ ] 初始化Python虚拟环境
- [ ] 创建requirements.txt依赖文件

#### 1.2 模型安装与测试
- [ ] 安装funASR库及相关依赖
- [ ] 下载Fun-ASR-Nano-2512模型
- [ ] 编写模型加载测试脚本
- [ ] 验证本地推理功能

### 阶段二：后端开发（第3-5天）

#### 2.1 基础框架搭建
- [ ] 选择并配置Web框架（Flask或FastAPI）
- [ ] 配置CORS跨域支持
- [ ] 创建基础API路由结构

#### 2.2 核心功能开发
- [ ] **音频处理模块**
  - [ ] 实现文件夹扫描功能
  - [ ] 音频文件格式验证（支持mp3, wav, m4a等）
  - [ ] 音频文件列表生成接口

- [ ] **语音识别模块**
  - [ ] 封装Fun-ASR推理接口
  - [ ] 实现单文件识别功能
  - [ ] 实现批量识别队列处理
  - [ ] 添加进度追踪机制

- [ ] **结果导出模块**
  - [ ] 创建Markdown文件生成器
  - [ ] 实现识别结果格式化
  - [ ] 添加文件保存路径管理

#### 2.3 API接口设计（本地文件路径处理）
```
POST /api/scan-folder        - 接收本地文件夹路径，返回音频文件列表
POST /api/start-recognition  - 基于本地文件路径开始批量识别
GET  /api/progress           - 获取识别进度
POST /api/export-results     - 将结果保存到本地指定目录
GET  /api/model-status       - 检查模型加载状态
```

**注意**: 前端传递本地文件路径（如 `/Users/xxx/audio`），后端直接读取

### 阶段三：前端开发（第4-6天）

#### 3.1 页面结构设计
参考界面包含以下区域：
- [ ] 顶部标题栏
- [ ] 文件夹选择区域
- [ ] 音频文件列表展示区
- [ ] 批量操作按钮区
- [ ] 进度显示区
- [ ] 结果预览区

#### 3.2 功能实现
- [ ] **文件夹选择**
  - [ ] 文件夹路径输入框（直接输入本地路径）
  - [ ] "扫描文件夹"按钮（调用后端扫描API）

- [ ] **文件列表展示**
  - [ ] 表格形式显示音频文件
  - [ ] 显示文件名、大小、本地完整路径
  - [ ] 显示处理状态（待处理/处理中/已完成）

- [ ] **批量操作**
  - [ ] "开始识别"按钮（触发后端本地处理）
  - [ ] "导出结果"按钮（保存到本地输出目录）
  - [ ] "清空列表"按钮

- [ ] **进度监控**
  - [ ] 整体进度条
  - [ ] 当前处理文件显示
  - [ ] 预计剩余时间

- [ ] **结果预览**
  - [ ] 识别结果文本展示
  - [ ] 显示结果文件保存路径

### 阶段四：联调与优化（第7天）

#### 4.1 功能联调
- [ ] 前后端接口对接
- [ ] 批量处理流程测试
- [ ] 错误处理完善

#### 4.2 性能优化
- [ ] 添加GPU加速支持（如可用）
- [ ] 实现并发处理控制
- [ ] 添加内存管理机制

#### 4.3 用户体验优化
- [ ] 添加加载动画
- [ ] 完善错误提示
- [ ] 添加操作日志

### 阶段五：文档与部署（第8天）

- [ ] 编写README使用说明
- [ ] 创建模型安装指南
- [ ] 编写API文档
- [ ] 制作启动脚本
- [ ] 打包发布

---

## 项目目录结构

```
AudioProcessingSystem/
├── backend/
│   ├── app.py                 # 主应用入口
│   ├── asr_engine.py          # ASR引擎封装
│   ├── audio_processor.py     # 音频处理模块
│   ├── result_exporter.py     # 结果导出模块
│   └── utils/
│       ├── file_utils.py      # 文件工具
│       └── config.py          # 配置文件
├── frontend/
│   ├── index.html             # 主页面
│   ├── css/
│   │   └── style.css          # 样式文件
│   └── js/
│       └── app.js             # 前端逻辑
├── models/                    # 模型存储目录
├── outputs/                   # 输出结果目录
├── requirements.txt           # Python依赖
├── README.md                  # 使用说明
└── 开发计划.md                # 本文件
```

---

## 核心功能说明

### 1. 批量识别流程（本地处理）
```
用户输入/粘贴本地文件夹路径 → 点击扫描
→ 后端读取本地文件系统 → 返回音频文件列表
→ 用户点击开始识别 → 后端直接读取本地音频文件进行ASR推理
→ 实时更新进度 → 完成后将结果保存到本地outputs目录
```

### 2. 数据流特点
- ✅ 无文件上传，零网络传输
- ✅ 后端直接读取本地文件系统
- ✅ 结果直接写入本地磁盘
- ✅ 支持大文件处理（无上传限制）

### 3. 结果文件格式
每个音频文件对应一个MD文件：
```markdown
# 音频识别结果

**文件名**: example.wav
**识别时间**: 2025-01-29 14:30:00

## 识别文本
这里是语音识别的内容...

## 元数据
- 文件大小: 3.2 MB
- 音频时长: 00:02:15
- 处理耗时: 1.2 秒
```

---

## 本地运行说明

### 启动步骤
```bash
# 1. 安装依赖
pip install -r requirements.txt

# 2. 启动本地服务器
python backend/app.py

# 3. 浏览器访问
# 打开浏览器访问 http://localhost:5000
```

### 使用流程
1. 在网页中输入音频文件夹的本地路径
   - Windows: `C:\Users\用户名\Documents\音频文件`
   - Mac: `/Users/用户名/Documents/音频文件`
2. 点击"扫描文件夹"获取音频列表
3. 点击"开始识别"进行批量处理
4. 处理完成后，结果自动保存到 `outputs/` 目录

---

## 依赖清单

```txt
flask>=2.3.0
funasr>=1.0.0
flask-cors>=4.0.0
python-dotenv>=1.0.0
```

---

## 预期交付物

1. ✅ 完整的Web应用系统
2. ✅ 支持批量音频识别
3. ✅ 自动生成Markdown结果文件
4. ✅ 实时进度显示
5. ✅ 完整的使用文档

---

*开发计划版本: v1.0*
*创建日期: 2025-01-29*
